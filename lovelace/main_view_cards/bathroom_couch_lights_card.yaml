type: custom:vertical-stack-in-card
cards:
- type: horizontal-stack
  cards:
    - type: light
      entity: light.bathroom_orb
      name: Bathroom Orb
    - type: light
      entity: light.couch
      name: Couch
      style: |
        :host {
          --paper-item-icon-active-color:
           {% if is_state('sensor.couch_light_color_name', 'Disable') %}
             #B5B5B5
           {% elif is_state('sensor.couch_light_color_name', 'White') %}
             rgb(255, 255, 255)
           {% else %}
            rgb[[ sensor.couch_light_color ]]
           {% endif %};
        }
- type: custom:state-switch
  entity: light.couch
  states:
    "on":
      type: custom:vertical-stack-in-card
      cards:
        - type: horizontal-stack
          cards:
            - type: 'custom:button-card'
              name: White
              styles:
                card:
                  - background-color: >
                      [[[
                        if (states['sensor.couch_light_color_name'].state == 'White')
                          return "#37464f";
                        return "#263137";
                      ]]]
              tap_action:
                action: call-service
                service: light.turn_on
                service_data:
                  entity_id: light.couch
                  rgb_color: [255, 255, 255]
              color: 'rgb(255, 255, 255)'
              color_type: icon
              icon: mdi:sofa
            - type: 'custom:button-card'
              name: Yellow
              styles:
                card:
                  - background-color: >
                      [[[
                        if (states['sensor.couch_light_color_name'].state == 'Yellow')
                          return "#37464f";
                        return "#263137";
                      ]]]
              tap_action:
                action: call-service
                service: light.turn_on
                service_data:
                  entity_id: light.couch
                  rgb_color: [255, 255, 0]
              color: 'rgb(255, 255, 0)'
              color_type: icon
              icon: mdi:sofa
            - type: 'custom:button-card'
              name: Blue
              styles:
                card:
                  - background-color: >
                      [[[
                        if (states['sensor.couch_light_color_name'].state == 'Blue')
                          return "#37464f";
                        return "#263137";
                      ]]]
              tap_action:
                action: call-service
                service: light.turn_on
                service_data:
                  entity_id: light.couch
                  rgb_color: [0, 0, 255]
              color: 'rgb(0, 0, 255)'
              color_type: icon
              icon: mdi:sofa
        - type: horizontal-stack
          cards:
            - type: 'custom:button-card'
              name: Red
              styles:
                card:
                  - background-color: >
                      [[[
                        if (states['sensor.couch_light_color_name'].state == 'Red')
                          return "#37464f";
                        return "#263137";
                      ]]]
              tap_action:
                action: call-service
                service: light.turn_on
                service_data:
                  entity_id: light.couch
                  rgb_color: [255, 0, 0]
              color: 'rgb(255, 0, 0)'
              color_type: icon
              icon: mdi:sofa
            - type: 'custom:button-card'
              name: Green
              styles:
                card:
                  - background-color: >
                      [[[
                        if (states['sensor.couch_light_color_name'].state == 'Green')
                          return "#37464f";
                        return "#263137";
                      ]]]
              tap_action:
                action: call-service
                service: light.turn_on
                service_data:
                  entity_id: light.couch
                  rgb_color: [0, 255, 0]
              color: 'rgb(0, 255, 0)'
              color_type: icon
              icon: mdi:sofa
            - type: 'custom:button-card'
              name: Purple
              styles:
                card:
                  - background-color: >
                      [[[
                        if (states['sensor.couch_light_color_name'].state == 'Purple')
                          return "#37464f";
                        return "#263137";
                      ]]]
              tap_action:
                action: call-service
                service: light.turn_on
                service_data:
                  entity_id: light.couch
                  rgb_color: [255, 0, 255]
              color: 'rgb(255, 0, 255)'
              color_type: icon
              icon: mdi:sofa
        - type: horizontal-stack
          cards:
            - type: entities
              entities:
                - input_text.couch_color
        - type: horizontal-stack
          cards:
            - type: custom:light-entity-card
              entity: light.couch
              header: false
              brightness: false
              color_temp: false
              white_value: false
              color_picker: true
              effects_list: false