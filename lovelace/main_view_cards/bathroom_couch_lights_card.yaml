type: custom:vertical-stack-in-card
cards:
- type: horizontal-stack
  cards:
    - type: light
      entity: light.bathroom_orb
      name: Bathroom Orb
    - type: 'custom:config-template-card'
      entities:
        - sensor.couch_light_color
      card:
        type: 'custom:card-modder'
        style:
          --paper-item-icon-active-color: "${ states['sensor.couch_light_color_name'].state == 'Disable' ? '#B5B5B5' : states['sensor.couch_light_color_name'].state == 'White' ? 'rgb(255, 255, 255)' : 'rgb[[ sensor.couch_light_color ]]' }"
        card:
          type: light
          entity: light.couch
          name: Couch
- type: conditional
  conditions:
    - entity: light.couch
      state: 'on'
  card:
    type: custom:vertical-stack-in-card
    cards:
      - type: horizontal-stack
        cards:
          - type: 'custom:config-template-card'
            entities:
              - sensor.couch_light_color_name
            card:
              type: 'custom:card-modder'
              style:
                --paper-card-background-color: "${ states['sensor.couch_light_color_name'].state == 'White' ? '#37464f' : '#263137' }"
              card:
                type: 'custom:button-card'
                name: White
                tap_action:
                  action: call-service
                  service: light.turn_on
                  service_data:
                    entity_id: light.couch
                    rgb_color: [255, 255, 255]
                color: 'rgb(255, 255, 255)'
                color_type: icon
                icon: mdi:sofa
          - type: 'custom:config-template-card'
            entities:
              - sensor.couch_light_color_name
            card:
              type: 'custom:card-modder'
              style:
                --paper-card-background-color: "${ states['sensor.couch_light_color_name'].state == 'Yellow' ? '#37464f' : '#263137' }"
              card:
                type: 'custom:button-card'
                name: Yellow
                tap_action:
                  action: call-service
                  service: light.turn_on
                  service_data:
                    entity_id: light.couch
                    rgb_color: [255, 255, 0]
                color: 'rgb(255, 255, 0)'
                color_type: icon
                icon: mdi:sofa
          - type: 'custom:config-template-card'
            entities:
              - sensor.couch_light_color_name
            card:
              type: 'custom:card-modder'
              style:
                --paper-card-background-color: "${ states['sensor.couch_light_color_name'].state == 'Blue' ? '#37464f' : '#263137' }"
              card:
                type: 'custom:button-card'
                name: Blue
                tap_action:
                  action: call-service
                  service: light.turn_on
                  service_data:
                    entity_id: light.couch
                    rgb_color: [0, 0, 255]
                color: 'rgb(0, 0, 255)'
                color_type: icon
                icon: mdi:sofa
      - type: horizontal-stack
        cards:
          - type: 'custom:config-template-card'
            entities:
              - sensor.couch_light_color_name
            card:
              type: 'custom:card-modder'
              style:
                --paper-card-background-color: "${ states['sensor.couch_light_color_name'].state == 'Red' ? '#37464f' : '#263137' }"
              card:
                type: 'custom:button-card'
                name: Red
                tap_action:
                  action: call-service
                  service: light.turn_on
                  service_data:
                    entity_id: light.couch
                    rgb_color: [255, 0, 0]
                color: 'rgb(255, 0, 0)'
                color_type: icon
                icon: mdi:sofa
          - type: 'custom:config-template-card'
            entities:
              - sensor.couch_light_color_name
            card:
              type: 'custom:card-modder'
              style:
                --paper-card-background-color: "${ states['sensor.couch_light_color_name'].state == 'Green' ? '#37464f' : '#263137' }"
              card:
                type: 'custom:button-card'
                name: Green
                tap_action:
                  action: call-service
                  service: light.turn_on
                  service_data:
                    entity_id: light.couch
                    rgb_color: [0, 255, 0]
                color: 'rgb(0, 255, 0)'
                color_type: icon
                icon: mdi:sofa
          - type: 'custom:config-template-card'
            entities:
              - sensor.couch_light_color_name
            card:
              type: 'custom:card-modder'
              style:
                --paper-card-background-color: "${ states['sensor.couch_light_color_name'].state == 'Purple' ? '#37464f' : '#263137' }"
              card:
                type: 'custom:button-card'
                name: Purple
                tap_action:
                  action: call-service
                  service: light.turn_on
                  service_data:
                    entity_id: light.couch
                    rgb_color: [255, 0, 255]
                color: 'rgb(255, 0, 255)'
                color_type: icon
                icon: mdi:sofa
      - type: horizontal-stack
        cards:
          - type: entities
            entities:
              - input_text.couch_color
      - type: horizontal-stack
        cards:
          - type: custom:light-entity-card
            entity: light.couch
            header: false
            brightness: false
            color_temp: false
            white_value: false
            color_picker: true
            effects_list: false